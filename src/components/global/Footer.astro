<script>
  const form = document.getElementById("newsletterForm");
  const submitButton = form.querySelector('button[type="submit"]');
  const buttonText = document.getElementById("buttonText");
  const successMessage = document.getElementById("successMessage");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    console.log("submit");

    if (submitButton.dataset.loading === "true") return;

    submitButton.dataset.loading = "true";
    buttonText.textContent = "Sender...";
    // successMessage.classList.add("hidden");

    const formData = new FormData(form);
    const data = Object.fromEntries(formData);
    data.message = "Nyhetsbrev";

    try {
      const response = await fetch(
        "https://hooks.zapier.com/hooks/catch/20590115/29x0bf4/",
        {
          method: "POST",
          body: JSON.stringify(data),
        }
      );
      console.log(response);
      if (response.ok) {
        form.reset();
        successMessage.textContent = "Takk, du vil motta vårt nyhetsbrev.";
      } else {
        throw new Error("Noe gikk galt");
      }
    } catch (error) {
      console.error("Error:", error);
    } finally {
      submitButton.dataset.loading = "false";
      buttonText.textContent = "Book et møte";
    }
  });
</script>

<footer>
  <div
    class="items-center w-full px-8 py-12 mx-auto md:px-12 lg:px-24 max-w-7xl lg:pt-32"
  >
    <div class="xl:gap-8 xl:grid xl:grid-cols-3">
      <div
        class="lg:inline-flex lg:items-end justify-between w-full xl:col-span-3"
      >
        <div>
          <a
            title="link to your page"
            aria-label="your label"
            href="/"
            class="text-xl lg:text-4xl inline-flex items-center font-medium"
          >
            ✺ GraphLab
          </a>
          <p class="mt-12 text-gray-500 text-lg lg:text-xl text-balance">
            Vi bygger Norges fremste kunnskapsmiljø innenfor kunstig intelligens
            og graf-teknologi.
          </p>
        </div>
        <form
          class="flex max-w-xl flex-col items-center mt-12"
          id="newsletterForm"
        >
          <div class="flex w-full flex-col gap-1 sm:flex-row">
            <label for="email" class="sr-only"></label>
            <input
              id="email"
              name="email"
              type="email"
              placeholder="Nyhetsbrev..."
              aria-label="Enter your email address"
              required=""
              class="lg:px-12 px-6 py-4 bg-white placeholder-gray-400 border border-gray-300 duration-200 focus:outline-none focus:ring focus:ring-regent-100 focus:border-regent-300 w-full rounded-full"
            /><button
              type="submit"
              aria-label="Nyhetsbrev"
              class="inline-flex items-center justify-center w-52 lg:px-12 px-6 py-4 text-center text-black duration-500 bg-regent-500 font-medium rounded-full text-base focus:outline-none focus:ring-2 focus:ring-offset-2 hover:text-white ring-offset-2 hover:bg-regent-900"
            >
              <span id="buttonText">Ja takk</span>
            </button>
          </div>
          <p id="successMessage" class="mt-4 h-4 text-green-600"></p>
        </form>
      </div>

      <div
        class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-6 xl:col-span-3 border-t pt-12 text-base text-gray-500"
      >
        <div class="md:gap-8 md:grid md:grid-cols-2">
          <div>
            <h3 class="text-black font-medium lg:text-xl text-lg">
              Navigasjon
            </h3><ul class="mt-4 space-y-2" role="list">
              <li>
                <a
                  title="link to your page"
                  aria-label="your label"
                  href="/"
                  class="hover:text-regent-600">Hjem</a
                >
              </li>
              <li>
                <a
                  title="link to your page"
                  aria-label="your label"
                  href="/blog"
                  class="hover:text-regent-600">Blogg</a
                >
              </li>
            </ul>
          </div>
          <div class="mt-12 md:mt-0">
            <h3 class="text-black font-medium lg:text-xl text-lg">
              Socials
            </h3><ul class="mt-4 space-y-2" role="list">
              <li>
                <a
                  title="link to your page"
                  aria-label="your label"
                  href="https://twitter.com/graphlabai"
                  target="_blank"
                  class="hover:text-regent-600">@ GraphLabAI</a
                >
              </li><li>
                <a
                  title="link to your page"
                  aria-label="your label"
                  href="https://huggingface.co/graphlabai"
                  target="_blank"
                  class="flex items-center hover:text-regent-600"
                >
                  <img
                    src="/images/hf-logo-pirate.png"
                    alt="HF Logo"
                    class="w-4 h-4 mr-1"
                  />
                  GraphLabAI
                </a>
              </li>
            </ul>
          </div>
        </div>
        <div class="md:gap-8 md:grid md:grid-cols-2">
          <div></div>
        </div>
      </div>
    </div>
  </div>
</footer>
